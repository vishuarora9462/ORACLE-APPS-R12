--This Query is to find the receipt number and Purchase order which are partially accounted in Journal Ledger

SELECT DISTINCT PO_NUMBER,RECEIPT_NUM  FROM 
(SELECT JTJ.TAX_DET_FACTOR_ID GL_DET_FAT,JTL.DET_FACTOR_ID,JTL.TAX_INVOICE_NUM,PHA.SEGMENT1 AS PO_NUMBER, RSH.RECEIPT_NUM
FROM JAI_TAX_JOURNAL_ENTRIES JTJ, JAI_TAX_LINES JTL, RCV_SHIPMENT_HEADERS RSH, RCV_SHIPMENT_LINES RSL,PO_HEADERS_ALL PHA
WHERE JTL.DET_FACTOR_ID=JTJ.TAX_DET_FACTOR_ID(+) and JTL.EVENT_TYPE_CODE = 'RECEIPT_CREATED'
AND RSL.SHIPMENT_HEADER_ID=RSH.SHIPMENT_HEADER_ID
AND RSL.PO_HEADER_ID=PHA.PO_HEADER_ID
AND RSL.SHIPMENT_HEADER_ID= JTL.TRX_ID
AND PHA.PO_HEADER_ID=RSL.PO_HEADER_ID 
AND  PHA.CREATION_DATE BETWEEN TO_DATE ('2024-04-01', 'YYYY-MM-DD')
                                 AND TO_DATE ('2024-04-30', 'YYYY-MM-DD')
--AND PHA.SEGMENT1=1023044447
AND exists ( select 1  from PO_LINE_LOCATIONS_ALL PLLA
 WHERE PLLA.MATCH_OPTION='P' AND PLLA.PO_HEADER_ID=PHA.PO_HEADER_ID 
)
 )
                                 WHERE GL_DET_FAT IS NULL
